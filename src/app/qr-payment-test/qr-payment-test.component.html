<style>
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    th,
    td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
    }

    th {
        background-color: #f2f2f2;
    }

    tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    .loading {
        text-align: center;
        margin: 20px;
    }

    .error {
        color: red;
        text-align: center;
        margin: 20px;
    }
</style>


<h1>dữ liệu giao dịch</h1>

<div id="loading" class="loading">Đang tải dữ liệu...</div>
<div id="error" class="error" style="display: none;"></div>
<div id="data-container"></div>

<script>
    console.log("TEST")
    document.addEventListener('DOMContentLoaded', function () {
        const apiUrl = 'https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhF4ow6KY0i5MMdKt9aEPxkXPke7lF9dr_IBt-7dlxaTCYK89CIM-lXf5qY7jrn9G6t229Iwkz3u_BMajDWbfBBeBeIZmAN0xGl9b03ZECcPu0-Tmwy_6LBun5b8kTDIKXJ7HOSqWlcYlW6OPhU1QRWf5SK9wedKyVnMLV5h4wuzbpcFUciOGMc6hnghsRQEytzcFo0lcP6DHNC6SRMZk-EMb6_MSUJihIxyVF7NapPN3cw1E4dNon8fiWxtcCyAhl3l3ZDIR9_A5jWewohvTKvV3T7Mt3y6zeOziM5&lib=MbobgF83VGNWrcCC3M4CGj24K8jOcnH58';
        const loadingElement = document.getElementById('loading');
        const errorElement = document.getElementById('error');
        const dataContainer = document.getElementById('data-container');

        // Fetch data from API
        fetch(apiUrl)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Không thể kết nối đến API. Mã lỗi: ' + response.status);
                }
                return response.json();
            })
            .then(result => {
                // Hide loading indicator
                loadingElement.style.display = 'none';

                // Check if there's an error in the API response
                if (result.error) {
                    throw new Error('API trả về lỗi: ' + result.error);
                }

                // Display data in a table
                const data = result.data;
                if (data && data.length > 0) {
                    // Create table
                    const table = document.createElement('table');

                    // Create table header
                    const thead = document.createElement('thead');
                    const headerRow = document.createElement('tr');

                    // Get column names from the first data item
                    const columns = Object.keys(data[0]);
                    columns.forEach(column => {
                        const th = document.createElement('th');
                        th.textContent = column;
                        headerRow.appendChild(th);
                    });

                    thead.appendChild(headerRow);
                    table.appendChild(thead);

                    // Create table body
                    const tbody = document.createElement('tbody');
                    data.forEach(item => {
                        const row = document.createElement('tr');
                        columns.forEach(column => {
                            const td = document.createElement('td');
                            td.textContent = item[column];
                            row.appendChild(td);
                        });
                        tbody.appendChild(row);
                    });

                    table.appendChild(tbody);
                    dataContainer.appendChild(table);
                } else {
                    dataContainer.innerHTML = '<p>Không có dữ liệu để hiển thị.</p>';
                }
            })
            .catch(error => {
                // Hide loading indicator and show error
                loadingElement.style.display = 'none';
                errorElement.textContent = 'Đã xảy ra lỗi: ' + error.message;
                errorElement.style.display = 'block';
                console.error('Error:', error);
            });
    });
</script>